.row
  .col-xs-12.col-sm-6
    %table.table.table-condensed
      %thead
        %tr
          %th
            type
          %th
            Count
      %tbody
        %tr#artists
          %td.name
          %td.count
        %tr#albums
          %td.name
          %td.count
        %tr#tracks
          %td.name
          %td.count
.row
  .col-xs-12#logs
    %h2
      Last 6 months
    #logs
      plays
      %span.count
    Popular Tracks
    %table.table.table-condensed#popular_tracks
      %thead
        %tr
          %th
            Track
          %th
            Plays
      %tbody#tracks

:javascript
  function populate_table(table, data) {
    for(i in data) {
      var track = data[i][0]; 
      var plays = data[i][1];
      table.append("<tr><td>" + track.title + "</td><td>" + plays + "</td></tr>");
    }
  }

  function set_albums(data) {
    var props = data.props;
    $("#albums").find($(".name")).text(data.type);
    $("#albums").find($(".count")).text(props.count);
  }

  function set_tracks(data) {
    var props = data.props;
    $("#tracks").find($(".name")).text(data.type);
    $("#tracks").find($(".count")).text(props.count);
  }

  function set_logs(data) {
    var props = data.props;
    $("#logs").find($(".count")).text(props.count);
    populate_table($("#popular_tracks").find("#tracks"), props["popular"])
  }

  function set_artists(data) {
    var props = data.props;
    $("#artists").find($(".name")).text(data.type);
    $("#artists").find($(".count")).text(props.count);
  }
                          
  $(document).ready(function() {
    get("#{url_for('/stats/albums')}", set_albums, null);
    get("#{url_for('/stats/artists')}", set_artists, null);
    get("#{url_for('/stats/tracks')}", set_tracks, null);
    get("#{url_for('/stats/logs')}", set_logs, null);
  });
